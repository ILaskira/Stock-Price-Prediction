# 📈 股價預測

本專案目標是預測未來的股價與漲跌方向，並探討不同資料與模型組合對預測效果的影響，核心模型為 LSTM 結合傅立葉轉換（FFT）與 GARCH 估計不確定性。

---

## 🎯 研究目標

1. 預測未來一天的 **股價**（連續型變數）
2. 預測未來一天的 **漲跌方向**（分類任務：二元/三元）
3. 探討財報與總體經濟變數是否有助於提升預測能力

---

## 🧾 資料說明

- 時間範圍：2019/10/29 至 2024/11/29
- 交易日數：共 1,238 天
- 資料來源：
  - **日資料（17 欄）**：收盤價、成交量、技術指標等（Yahoo、TEJ）
  - **月資料（20 欄）**：利率、GDP、CPI、失業率等（台灣＋美國）
  - **季資料（9 欄）**：財報指標（來自 TEJ）
- 從多種角度分析後發現，其他財報與總體經濟變數對股價預測幫助有限，因此最終以 **收盤價作為主要變數**。

---

## 🔧 模型流程

### Step 1：預測對數報酬率（Log Return）
- 利用 **2 層 LSTM 模型**
- 訓練集長度(天數)：25、學習率: 0.001

### Step 2：訊號去噪（FFT）
- 使用傅立葉轉換移除高頻雜訊
- 最佳截止頻率 cutoff = **0.33**

### Step 3：預測去噪後報酬率
- 再次訓練 LSTM 模型預測平滑過的 ![預測公式](./CodeCogsEqn (1).svg)

### Step 4：預測收盤價
- 利用轉換關係：
  ![預測公式](./CodeCogsEqn.svg)

### Step 5：建立信賴區間（GARCH）
- 對 log return 建立 **GARCH(1,1)** 模型估計波動
- 建立 **95% 預測區間**

---

## 📊 漲跌方向預測結果

| 分類類型   | 最佳正確率 |
|------------|------------|
| 二元分類（上漲 / 下跌） | 約 **80%** |
| 三元分類（上漲 / 不變 / 下跌） | 約 **70.5%** |

---

## 🔍 特徵選擇與重要性

- 採用 Permutation Importance 與 Forward Selection
- 在未經處理的資料下，使用其他變數無明顯幫助
- 在 FFT 處理過的資料下：
  - **少數變數**（如 volume, turnover）可略為提升效果
  - 但最佳模型仍為僅使用去噪後的 log return

---

## ✅ 結論摘要

- **直接預測價格效果最差**，因時間序列具高度自相關
- **log return 是更穩定的預測目標**
- **使用傅立葉轉換（FFT）對 log return 去噪後，預測效果明顯提升**
- **財報與總體經濟變數並未顯著提升預測能力**

| 預測方法                 | RMSE   |
|--------------------------|--------|
| 零基準（Always predict 0） | 1.594  |
| 原始 log return          | 1.588  |
| FFT 去噪後報酬率          | **0.993** |
| 全變數模型（共 47 變數）   | 1.592  |
| 選 3 個重要變數（FFT）     | 1.230  |

---

## 📁 專案檔案

- [📄 股價預測報告 PDF](./統實_final_report.pdf)

---
